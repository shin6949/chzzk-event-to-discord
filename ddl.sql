create table bot_profile_data (id bigserial not null, username varchar(100) not null, avatar_url varchar(600) not null, owner_id varchar(255) not null, primary key (id));
create table chzzk_category (updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP not null, category_id varchar(255) not null, category_name varchar(255) not null, category_type varchar(255) not null, poster_image_url varchar(255) not null, primary key (category_id, category_type));
create table chzzk_channel (follower_count integer not null, is_live boolean not null, is_verified_mark boolean not null, last_check_time TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP not null, version BIGINT(20) DEFAULT 0 not null, channel_name varchar(33) not null, channel_description varchar(550), profile_url varchar(32780), channel_id varchar(255) not null, primary key (channel_id));
create table chzzk_subscription_form (enabled BIT default false not null, interval_minute integer default 10 not null, bot_profile_id bigint not null, created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP not null, id bigserial not null, webhook_id bigint not null, color_hex varchar(11) not null, content varchar(2000) not null, channel_id varchar(255), form_owner varchar(255) not null, language varchar(255) not null check (language in ('English','Korean','Spanish','German','Portuguese','Russian','French','Japanese','Chinese','Italian','Turkish','Polish','Arabic','Thai','Czech','Hungarian','Dutch','Finnish','Swedish','Danish','Norwegian','Greek','Slovak','Romanian','Bulgarian','Indonesian','Ukrainian','Tagalog','Catalan','Hindi','Malay','Vietnamese','Uzbek','American_Sign_Language','ZH_HK','Other')), type varchar(255) not null check (type in ('STREAM_ONLINE','STREAM_OFFLINE','CHANNEL_UPDATE')), primary key (id));
create table discord_webhook_data (id bigserial not null, name varchar(500) not null, webhook_url varchar(500) not null, meno TEXT, owner_id varchar(255) not null, primary key (id));
create table notification_log (created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP not null, form_id BIGINT UNSIGNED not null, log_id bigserial not null, primary key (log_id));
alter table if exists bot_profile_data add constraint FK_BOT_PROFILE_DATA_OWNER_ID foreign key (owner_id) references chzzk_channel;
alter table if exists chzzk_subscription_form add constraint FK_CHZZK_SUBSCRIPTION_FORM_BOT_PROFILE_ID foreign key (bot_profile_id) references bot_profile_data;
alter table if exists chzzk_subscription_form add constraint FK_CHZZK_SUBSCRIPTION_FORM_CHANNEL_ID foreign key (channel_id) references chzzk_channel;
alter table if exists chzzk_subscription_form add constraint FK_CHZZK_SUBSCRIPTION_FORM_OWNER_CHANNEL_ID foreign key (form_owner) references chzzk_channel;
alter table if exists chzzk_subscription_form add constraint FK_CHZZK_SUBSCRIPTION_FORM_WEBHOOK_ID foreign key (webhook_id) references discord_webhook_data;
alter table if exists discord_webhook_data add constraint FK_WEBHOOK_DATA_OWNER_ID foreign key (owner_id) references chzzk_channel;
alter table if exists notification_log add constraint FK_NOTIFICATION_LOG_FORM_ID foreign key (form_id) references chzzk_subscription_form;
